#!/usr/bin/env bash
# Replace Styles From Snippet Script
# Usage: replace-styles-from-snippet <target-doc> <snippet-file> [snippet-id]

set -euo pipefail

if [ $# -lt 2 ]; then
    echo "Usage: replace-styles-from-snippet <target-doc> <snippet-file> [snippet-id]"
    echo "  target-doc: Document that will have styles replaced (will be modified)"
    echo "  snippet-file: XML file containing style snippets"
    echo "  snippet-id: ID of the snippet to use (e.g., 'listStylesDefault')"
    echo ""
    echo "Example:"
    echo "  replace-styles-from-snippet target.docx core/partials/styles/list-styles.xml listStylesDefault"
    exit 1
fi

# Get the script directory to find the project
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../../.." && pwd)"

# Run the dotnet command from the project file
dotnet run --project "$PROJECT_ROOT/src/OpenXmlApp/OpenXmlApp.csproj" -- replace-styles-from-snippet "$@"
