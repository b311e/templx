#!/usr/bin/env bash
# OpenXML Replace Styles Alias
# Usage: replace-styles <target-doc> <source-doc>
#   target-doc: Document that will receive new styles (will be modified)
#   source-doc: Document with styles to copy from (read-only)

set -euo pipefail

if [ $# -lt 2 ]; then
    echo "Usage: replace-styles <target-doc> <source-doc>"
    echo "  target-doc: Document that will receive new styles (will be modified)"
    echo "  source-doc: Document with styles to copy from (read-only)"
    echo ""
    echo "Example:"
    echo "  replace-styles document.docx template.dotx"
    exit 1
fi

# Get the script directory to find the project
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
# PROJECT_ROOT should point to the repository root. The replace-styles script lives at:
#   <repo>/src/scripts/replace_styles/replace-styles
# so we need to go up three levels to reach the repo root.
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../../.." && pwd)"

# Run the dotnet command from the project file. Use "--" to ensure any
# subsequent arguments are forwarded to the application (not to dotnet).
dotnet run --project "$PROJECT_ROOT/src/OpenXmlApp/OpenXmlApp.csproj" -- replace-styles "$@"
