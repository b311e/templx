#!/usr/bin/env bash
# List Styles Script
# Usage: list-styles <templatePath>

set -euo pipefail

if [[ "$1" == "help" || "$1" == "--help" || "$1" == "-h" ]] 2>/dev/null; then
    echo "Usage: list-styles <templatePath>"
    echo ""
    echo "Extract and list all styles from a Word template"
    echo ""
    echo "Arguments:"
    echo "  templatePath  - Path to template directory (builds/<agency>/<category>/<templateName>)"
    echo "                  Template folder should contain in/, out/, src/, etc. folders"
    echo ""
    echo "Output:"
    echo "  Style list saved to docs/style-list-{templateName}.txt in template directory"
    echo ""
    echo "Examples:"
    echo "  list-styles builds/jbc/workspace/jbcNormal"
    echo "  list-styles builds/olls/templates/OLLS_Contract_Personal_Services_Template"
    exit 0
fi

if [ $# -eq 0 ]; then
    echo "Usage: list-styles <templatePath>"
    echo "Run 'list-styles --help' for more information"
    exit 1
fi

# Get the script directory to find the style script
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
STYLE_SCRIPT="$SCRIPT_DIR/style/style"

# Call the existing style script with --list
"$STYLE_SCRIPT" --list "$1"
